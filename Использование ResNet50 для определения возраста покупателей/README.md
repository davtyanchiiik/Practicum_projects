# Определение возраста покупателей по фотографиям

## Описание проекта

Сетевой супермаркет **«Хлеб-Соль»** внедряет систему компьютерного зрения для анализа фотографий покупателей. Основные задачи:
1. **Анализировать покупки** и предлагать товары, которые могут заинтересовать покупателей соответствующей возрастной группы.
2. **Контролировать добросовестность кассиров** при продаже алкоголя и других возрастных товаров.

### Цель проекта
Разработать модель машинного обучения, которая сможет определять приблизительный возраст человека по фотографии.

---

## Этапы выполнения

### 1. Проведение исследовательского анализа данных (EDA)
- Проведён анализ распределения возрастов в обучающем датасете.
- Выявлено, что возрастная выборка сбалансирована и подходит для обучения модели.

### 2. Подготовка данных
- Все изображения были предварительно обработаны:
  - Приведены к размеру **224x224 пикселя** для соответствия требованиям модели ResNet50.
  - Выполнено нормирование значений пикселей (масштабирование от 0 до 1).
  - Реализован аугментационный пайплайн:
    - Случайные повороты и сдвиги изображений.
    - Горизонтальные отражения.
    - Изменение яркости и контраста.
- Данные разделены на тренировочную, валидационную и тестовую выборки.

### 3. Обучение модели
Для обучения использована предварительно обученная нейронная сеть **ResNet50** (предобучение на ImageNet). Изменения архитектуры:
- Удалены оригинальные полносвязные слои.
- Добавлен слой **GlobalAveragePooling2D** для упрощения выходных данных сверточных слоев.
- Добавлен один полносвязный слой с одним нейроном, предсказывающим возраст (регрессия).

Параметры обучения:
- **Функция потерь:** MSE (Mean Squared Error).
- **Метрика:** MAE (Mean Absolute Error).
- **Оптимизатор:** Adam с learning rate = 0.0001.

---

## Результаты

- Модель достигла **MAE = 6.53** на валидационной выборке.
- Целевое значение MAE **< 8** было успешно достигнуто.
- Результат **MAE = 6.53** близок к эталонному значению (5.4), указанному в статье о датасете.
- На тренировочной выборке MAE = 3.13. Разница между тренировочной и валидационной метриками незначительна, что указывает на **отсутствие переобучения**.

---

## Выводы

- **Модель ResNet50** с минимальными изменениями показала высокую эффективность для задачи определения возраста.
- Достигнутое значение MAE = 6.53 говорит о хорошей точности модели и её пригодности для реального использования.
- Рекомендации:
  - Для дальнейшего улучшения качества можно использовать ансамблевые методы или более сложные архитектуры.
  - Увеличить обучающую выборку для повышения обобщающей способности модели.
