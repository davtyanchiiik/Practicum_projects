# Определение целесообразности покупки коров для молочного хозяйства

## Описание проекта

Проект выполняется по заказу фермера из молочного хозяйства **«Вольный луг»**, который хочет расширить своё поголовье коров. Для этого он планирует закупить бурёнок у ассоциации пастбищ **«ЭкоФерма»**. Главные критерии отбора:  
- Годовой удой коровы должен быть **не менее 6000 кг молока**.
- Молоко должно быть **вкусным** по строгим критериям заказчика.

Для принятия решения необходимо разработать две модели машинного обучения:
1. **Модель регрессии** для прогнозирования годового удоя коровы.
2. **Модель классификации** для определения вероятности того, что молоко будет вкусным.

---

## Данные

### Файлы:
1. **`ferma_main.csv`** — текущий состав стада:
   - **id** — уникальный идентификатор коровы;
   - **Удой, кг** — годовой удой молока (целевой признак для регрессии);
   - **ЭКЕ** — энергетическая кормовая единица;
   - **Сырой протеин, г** — содержание протеина в корме;
   - **СПО** — сахаро-протеиновое соотношение;
   - **Порода**, **порода папы_быка** — генетические данные;
   - **Тип пастбища** — тип ландшафта, где паслась корова;
   - **Жирность, %** и **Белок, %** — характеристики молока;
   - **Вкус молока** — бинарный признак (целевой для классификации);
   - **Возраст** — младше или старше двух лет.

2. **`ferma_dad.csv`** — данные о папах коров:
   - **id** — уникальный идентификатор коровы;
   - **Имя Папы** — имя быка-отца.

3. **`cow_buy.csv`** — данные о коровах, доступных для покупки:
   - Похожие признаки, но отсутствуют показатели корма и целевые признаки **Удой** и **Вкус молока**.

---

## Цели проекта

1. Построить две прогнозные модели:
   - Регрессионную модель для предсказания удоя.
   - Классификационную модель для оценки вкуса молока.
2. Отобрать коров, соответствующих следующим критериям:
   - Удой **≥ 6000 кг/год**.
   - Молоко признано вкусным.
3. Дать рекомендации по дальнейшему сбору данных и улучшению моделей.

---

## Этапы работы

### 1. Загрузка и предобработка данных
- Приведены названия и типы данных в файлах к единому стандарту.
- Удалены явные дубликаты, обработаны неявные.
- Пропуски отсутствовали.

### 2. Исследовательский анализ данных (EDA)
- Выявлены выбросы в признаке **Удой, кг** (аномальные значения до 45 000 кг удалены).
- Проведён анализ распределений:
  - Нормальное распределение наблюдалось только у признаков **Удой** и **ЭКЕ**.
  - Остальные признаки имели ненормальное или бимодальное распределение.
- Основные соотношения:
  - **Породы:** Вис Бик Айдиал (59%) и Рефлешн Соверинг (41%).
  - **Тип пастбища:** Холмистое (56%) и Равнинное (44%).
  - **Возраст:** Большинство коров старше 2 лет (82.5%).
  - **Вкус молока:** 41% коров дают невкусное молоко.

### 3. Корреляционный анализ
- Умеренная линейная связь между удоем и **Сырой протеин** (коэффициент корреляции = 0.44).
- Зависимость между удоем и **ЭКЕ** оказалась квадратичной.
- Признаки **СПО** и **Жирность** показали тенденцию к кластеризации.
- Для устранения нелинейной зависимости добавлены новые признаки:
  - **ЭКЕ²** (квадрат энергетической кормовой единицы).
  - Преобразование **СПО** в категориальный признак.

### 4. Построение моделей
#### Модель регрессии:
- Выбрана модель линейной регрессии.
- Коэффициент детерминации **R² = 0.8248** (точность предсказания удоя ≈ 82.5%).

#### Модель классификации:
- Использована логистическая регрессия.
- Рекомендованный порог вероятности: **0.86**.
- Метрики:
  - **Accuracy** (точность): высокая.
  - **Recall** (полнота) и **Precision** (точность): учитываются для анализа рисков.

---

## Итоговые выводы и рекомендации

1. **Отобранные коровы для покупки:**
   - Коровы с номерами **5, 12, 17** соответствуют критериям:
     - Удой: **более 6000 кг/год**.
     - Молоко вкусное.

2. **Рекомендации по улучшению моделей:**
   - Расширить сбор данных, добавив больше наблюдений и новых признаков (например, данные о климате, сезонности, типе кормов).
   - Улучшить качество модели регрессии с помощью методов нелинейной регрессии.

3. **Общие рекомендации:**
   - Продолжить наблюдение за продуктивностью стада после покупки новых коров.
   - Анализировать полученные данные для повышения точности прогнозов.
