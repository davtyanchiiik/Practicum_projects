# Определение стоимости автомобилей по их характеристикам

## Описание проекта

Сервис по продаже автомобилей с пробегом **«Не бит, не крашен»** разрабатывает приложение, которое позволяет пользователям быстро узнать рыночную стоимость своего автомобиля. Для этого необходимо построить модель машинного обучения, которая сможет с высокой точностью предсказывать стоимость автомобилей на основе их характеристик.

### Цели проекта
1. Построить модель для определения стоимости автомобилей.
2. Удовлетворить критерии заказчика:
   - Высокая точность предсказаний (RMSE < 2500).
   - Быстрое время предсказания.
   - Умеренное время обучения модели.

---

## Этапы выполнения

### 1. Загрузка и изучение данных
- Данные загружены из файла `/datasets/autos.csv`.
- Проведён анализ структуры и распределений данных.
- Исследованы следующие признаки:
  - Технические характеристики: тип кузова, коробка передач, мощность, тип топлива, марка, модель и др.
  - Временные характеристики: год регистрации, дата создания анкеты, дата последней активности и др.
  - Целевой признак: цена автомобиля (`Price`).

### 2. Предобработка данных
- Устранены пропуски, так как их заполнение логически обосновать не удалось.
- Выявлены и удалены явные дубликаты.
- Удалены неинформативные признаки, такие как `DateCrawled`, `DateCreated`, `PostalCode`, `NumberOfPictures`, которые не влияют на стоимость автомобиля.
- Обработаны выбросы в числовых признаках.
- Признаки подготовлены к обучению:
  - Категориальные признаки закодированы с использованием техники `One-Hot Encoding`.
  - Числовые признаки нормализованы.

### 3. Обучение моделей
- Данные разделены на тренировочную и тестовую выборки в пропорции 80:20.
- Создан пайплайн для предобработки данных и обучения моделей.
- Обучены следующие модели:
  - **LightGBM (LGBMRegressor)** — модель градиентного бустинга.
  - **DecisionTreeRegressor** — модель решающего дерева.
  - **LinearRegression** — линейная регрессия.

---

## Результаты

### Качество моделей
| Модель                | RMSE на валидации | RMSE на тесте  |
|-----------------------|-------------------|----------------|
| **LGBMRegressor**     | **1452.64**      | **1449.48**    |
| DecisionTreeRegressor | 1876.81          | 1874.65        |
| LinearRegression      | 2072.76          | 2068.94        |

- **LGBMRegressor** продемонстрировала наилучшую точность с RMSE = 1452.64, что существенно меньше целевого значения RMSE < 2500.
- **DecisionTreeRegressor** и **LinearRegression** оказались менее точными, но быстрее в обучении и предсказании.

### Время обучения и предсказания
| Модель                | Время обучения (с) | Время предсказания (с) |
|-----------------------|-------------------|-----------------------|
| **LGBMRegressor**     | 0.56             | 0.03                  |
| DecisionTreeRegressor | 3.37             | 0.005                 |
| LinearRegression      | 0.29             | 0.001                 |

- Модель **LGBMRegressor** немного уступает в скорости обучения, но обеспечивает высокую точность предсказаний и достаточно быстрое время выполнения предсказаний.

---

## Выводы

- Наилучшей моделью для задачи определения стоимости автомобилей является **LGBMRegressor**, которая продемонстрировала:
  - Высокую точность: RMSE = 1449.48 на тестовой выборке.
  - Умеренное время обучения (0.56 секунд).
  - Быстрое время предсказания (0.03 секунд).
- Остальные модели, такие как **DecisionTreeRegressor** и **LinearRegression**, являются менее точными и уступают по большинству критериев.

---

## Рекомендации

- Для дальнейшего улучшения модели рекомендуется:
  1. Увеличить объём обучающей выборки, чтобы повысить обобщающую способность модели.
  2. Провести более тщательный подбор гиперпараметров для моделей, особенно для **LGBMRegressor**.
  3. Рассмотреть возможность использования ансамблей моделей для повышения точности.
