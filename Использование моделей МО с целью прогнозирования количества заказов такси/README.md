# Прогнозирование количества заказов такси

## Описание проекта

Компания **«Чётенькое такси»** стремится повысить эффективность работы и уменьшить время ожидания такси в периоды пиковых нагрузок. Для этого требуется спрогнозировать количество заказов на следующий час, чтобы обеспечить своевременное присутствие достаточного числа водителей.  

---

## Цель проекта

Разработать модель машинного обучения для прогнозирования количества заказов такси на следующий час с метрикой RMSE ≤ 48 на тестовой выборке.

---

## Этапы работы

1. **Загрузка и предобработка данных:**
   - Данные загружены из файла `taxi.csv`.
   - Выполнено ресемплирование данных с агрегацией по одному часу.
   - Пропуски отсутствуют, данные соответствуют описанию задачи.

2. **Анализ данных:**
   - Выявлены основные тренды и сезонности:
     - Растущий тренд: за последние восемь месяцев количество заказов увеличилось почти втрое.
     - Дневная сезонность: минимальное количество заказов утром, максимум — вечером и ночью.
   - Присутствуют шумы, которые учитывались при обучении моделей.

3. **Обучение моделей:**
   - Тестовая выборка составила 10% от исходных данных.
   - Перебраны различные модели и гиперпараметры с использованием RandomizedSearchCV.
   - Оценка производительности моделей проводилась с использованием метрики RMSE.

4. **Тестирование лучшей модели:**
   - Лучшей моделью оказалась **LGBMRegressor** с параметрами:
     - `max_depth=5`
     - `num_leaves=20`
     - `random_state=42`
   - RMSE на кросс-валидации составило 25.27.
   - RMSE на тестовой выборке составило 44.47.

5. **Итоговые выводы:**
   - Модель успешно предсказывает количество заказов на следующий час.
   - Значение RMSE на тестовой выборке соответствует заданному порогу (≤ 48).
   - Прогнозирование учитывает как общий тренд, так и дневную сезонность.

---

## Результаты

### Ключевые выводы:
1. **Тренды:**
   - Количество заказов растёт со временем, что свидетельствует об увеличении популярности сервиса.
   - Наблюдается ярко выраженная дневная сезонность.

2. **Выбранная модель:**
   - **LGBMRegressor** показала минимальное значение RMSE на тестовой выборке (44.47).
   - Подобранные гиперпараметры обеспечивают оптимальное соотношение качества и производительности.

3. **Рекомендации:**
   - Учитывать прогнозы модели для планирования количества водителей в конкретные часы.
   - Регулярно обновлять модель и данные для учёта изменяющихся трендов и сезонностей.

---

## Технические детали

- **Данные:**
  - Исторические данные о заказах такси с агрегацией по часу.
  - Столбец `num_orders` содержит целевое значение — количество заказов.

- **Использованные библиотеки:**
  - Python: pandas, numpy, scikit-learn, lightgbm, matplotlib, seaborn.
  - Модели: `LGBMRegressor` и другие регрессоры для сравнения.

- **Метрика качества:**
  - **RMSE (Root Mean Squared Error)**:
    - Целевое значение на тестовой выборке ≤ 48.
    - Достигнутое значение: 44.47.

---

## Заключение

- Разработанная модель прогнозирования количества заказов такси на следующий час соответствует требованиям бизнеса.
- Прогнозы модели могут быть использованы для оптимизации распределения водителей и повышения уровня обслуживания.
- Для повышения точности прогнозов в будущем рекомендуется учитывать дополнительные факторы, такие как погодные условия или локальные события, влияющие на спрос.
